<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<title>Transformations</title>
<link href="style.css" rel="stylesheet" type="text/css">
</head>
<body background="images/back.gif">

<!--START-->

<h3>Trasformazioni</h3>

Una trasformazione vi consente di cambiare il luogo in cui vengono tracciati gli elementi 
nel mondo tridimensionale. Per esempio, la funzione per disegnare dei blocchi può raffigurare
esclusivamente blocchi ad ascisse parallelo. Impostando una 
trasformazione a rotazione potete creare blocchi rotanti. Anche gli sprite vengono sempre 
disegnati parallelamente al piano xy. Impostando una trasformazione potete cambiare tutto ciò. 
Esistono due tipi di funzioni: funzioni che impostando la trasformazione e funzioni che 
aggiungono trasformazioni.

<p>
<blockquote>
  <tt><b>d3d_transform_set_identity()</b></tt>
	  Imposta la trasformazione alla identificazione (nessuna trasformazione).<br>
  <tt><b>d3d_transform_set_translation(xt,yt,zt)</b></tt>
	  Imposta la trasformazione ad una traslazione sopra la rotta indicata.<br>
  <tt><b>d3d_transform_set_scaling(xs,ys,zs)</b></tt>
	  Imposta la trasformazione per scalare con il valore indicato.<br>
  <tt><b>d3d_transform_set_rotation_x(angle)</b></tt>
	  Imposta la trasformazione ad una rotazione intorno all’ascisse-x con l’ammontare indicato.<br>
  <tt><b>d3d_transform_set_rotation_y(angle)</b></tt>
	  Imposta la trasformazione per una rotazione intorno all’ascisse-y con l’ammontare indicato.<br>
  <tt><b>d3d_transform_set_rotation_z(angle)</b></tt>
	  Imposta la trasformazione ad una rotazione intorno all’ascisse-z con l’ammontare indicato.<br>
  <tt><b>d3d_transform_set_rotation_axis(xa,ya,za,angle)</b></tt>
	  Imposta la trasformazione ad una rotazione intorno all’ascisse indicato dalla rotta 
	  con l’ammontare indicato..<br>
  <tt><b>d3d_transform_add_translation(xt,yt,zt)</b></tt>
	  Imposta una trasformazione sopra la rotta indicata.<br>
  <tt><b>d3d_transform_add_scaling(xs,ys,zs)</b></tt>
	  Aggiunge una scalatura con l’ammontare indicato.<br>
  <tt><b>d3d_transform_add_rotation_x(angle)</b></tt>
	  Aggiunge una rotazione intorno all’ascisse-x con il valore indicato.<br>
  <tt><b>d3d_transform_add_rotation_y(angle)</b></tt>
	  Aggiunge una rotazione intorno all’ascisse-y con l’ammontare indicato.<br>
  <tt><b>d3d_transform_add_rotation_z(angle)</b></tt>
	  Aggiunge una rotazione intorno all’ascisse-z con il valore indicato.<br>
  <tt><b>d3d_transform_add_rotation_axis(xa,ya,za,angle)</b></tt>
	  Aggiunge una rotazione intorno all’ascisse indicato dal vettore 
	  con l’ammontare indicato.<br>
</blockquote>

Osservate che la rotazione e lo scaling vengono effettuati in relazione al punto di intersezione del mondo 3D,
e non in relazione all’oggetto che è stato raffigurato. Se l’oggetto non è nel punto di intersezione, sarà 
spostato in un punto diverso, che è quello che non volete. Quindi, per esempio per ruotare un oggetto sopra 
il suo ascisse-x, dobbiamo prima portarlo nel punto di intersezione, ruotarlo, e infine riportarlo nella sua 
posizione. Questo è quello che le funzioni fanno per aggiungere delle trasformazioni.

<p>

Gli esempi che seguono possono spiegare meglio questo concetto. Supponiamo di avere uno sprite <tt>spr</tt> che 
vogliamo disegnare alla posizione (100,100,10). Possiamo usare il seguente codice per fare ciò

<p>
<blockquote>
<pre>
{
  d3d_transform_set_translation(100,100,10);
  draw_sprite(spr,0,0,0);
  d3d_transform_set_identity();
}
</pre>
</blockquote>

<p>

Si noti che dato il nostro uso di una traslazione dovremmo disegnare lo sprite alla posizione (0,0). (Questo 
assume che l’istanza corrente ha una profondità 0! Se non siete sicuri, impostate prima la profondità). Se 
vogliamo usare il suddetto nel nostro fps non vedremo lo sprite. La ragione è che lo sprite è parallelo 
al piano-xy. Vogliamo ruotarlo sopra 90 gradi e lungo l’ascisse-x o y. In questo caso abbiamo
bisogno di aggiungere una rotazione. Ricordate l’ordine: dobbiamo prima ruotare lo sprite e poi traslarlo. 
Potete usare cosi il codice seguente:

<p>
<blockquote>
<pre>
{
  d3d_transform_set_identity();
  d3d_transform_add_rotation_x(90);
  d3d_transform_add_translation(100,100,10);
  draw_sprite(spr,0,0,0);
  d3d_transform_set_identity();
}
</pre>
</blockquote>

<p>
Sometimes you temporarily want to save the current transformation, for example to add
an additional transformation and then restore the old one (this often happens when
drawing hierarchical models). To this end you can push the current transformation on a
stack and later pop it from the stack to make it the current transformation again. The
following functions exist for this:

<p>
<blockquote>
  <tt><b>d3d_transform_stack_clear()</b></tt>
	  Clears the stack of transformations.<br>
  <tt><b>d3d_transform_stack_empty()</b></tt>
	  Returns whether the transformation stack is empty.<br>
  <tt><b>d3d_transform_stack_push()</b></tt>
	  Pushes the current transformation on the stack. Returns whether there was
	  room on the stack to push it there (if you forget popping transformation
	  you at some moment will run out of room on the stack).<br>
  <tt><b>d3d_transform_stack_pop()</b></tt>
	  Pops the top transformation from the stack and makes it the current one.
	  Returns whether there was a transformation on the stack.<br>
  <tt><b>d3d_transform_stack_top()</b></tt>
	  Makes the top transformation the current one, but does not remove it from the stack.
	  Returns whether there was a transformation on the stack.<br>
  <tt><b>d3d_transform_stack_discard()</b></tt>
	  Removes the top transformation from the stack but does not make it the current one.
	  Returns whether there was a transformation on the stack.<br>
</blockquote>

<p>
Using transformation is a powerful mechanism. But be careful and always set the transformation
back to the identity once you are done.

<!--END-->

</body>
</html>

<!-- KEYWORDS
transformations

d3d_transform_set_identity()
d3d_transform_set_translation()
d3d_transform_set_scaling()
d3d_transform_set_rotation_x()
d3d_transform_set_rotation_y()
d3d_transform_set_rotation_z()
d3d_transform_set_rotation_axis()
d3d_transform_add_translation()
d3d_transform_add_scaling()
d3d_transform_add_rotation_x()
d3d_transform_add_rotation_y()
d3d_transform_add_rotation_z()
d3d_transform_add_rotation_axis()
d3d_transform_stack_clear()
d3d_transform_stack_empty()
d3d_transform_stack_push()
d3d_transform_stack_pop()
d3d_transform_stack_top()
d3d_transform_stack_discard()

--> 
